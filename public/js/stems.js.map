{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/@artcommacode/q/index.js","src/js/components/Button.js","src/js/components/Stem.js","src/js/components/Track.js","src/js/components/publisher.js","src/js/stems.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AC/BA;;;;;;;AAOA,SAAS,UAAT,CAAoB,EAApB,EAAwB,WAAxB,EAAqC,SAArC,EAAgD;AAC/C,KAAM,SAAS,EAAf;AACA,QAAO,OAAP,GAAiB,EAAjB;;AAEA,QAAO,MAAP,GAAgB,SAAS,MAAT,GAAkB;AACjC,SAAO,OAAP,GAAiB,IAAjB;AACA,SAAO,OAAP,CAAe,SAAf,CAAyB,GAAzB,CAA6B,SAA7B;AACA,EAHD;;AAKA,QAAO,OAAP,GAAiB,SAAS,OAAT,GAAmB;AACnC,SAAO,OAAP,GAAiB,KAAjB;AACA,SAAO,OAAP,CAAe,SAAf,CAAyB,MAAzB,CAAgC,SAAhC;AACA,EAHD;;AAKA,QAAO,aAAP,GAAuB,SAAS,aAAT,GAAyB;AAC/C,MAAI,OAAO,OAAX,EAAoB;AACnB,UAAO,OAAP;AACA,GAFD,MAEO;AACN,UAAO,MAAP;AACA;AACD,EAND;;AAQA,QAAO,QAAP,GAAkB,SAAS,QAAT,GAAoB;AACrC,MAAI,CAAC,OAAO,OAAZ,EAAqB,OAAO,MAAP;AACrB,SAAO,MAAP,GAAgB,IAAhB;AACA,SAAO,OAAP,CAAe,SAAf,CAAyB,GAAzB,CAA6B,QAA7B;AACA,EAJD;;AAMA,QAAO,UAAP,GAAoB,SAAS,UAAT,GAAsB;AACzC,SAAO,MAAP,GAAgB,KAAhB;AACA,SAAO,OAAP,CAAe,SAAf,CAAyB,MAAzB,CAAgC,QAAhC;AACA,EAHD;;AAKA,QAAO,YAAP,GAAsB,SAAS,YAAT,CAAsB,UAAtB,EAAkC;AACvD,SAAO,MAAP,GAAgB,cAAc,CAAC,OAAO,MAAtC;AACA,MAAI,OAAO,MAAP,KAAkB,IAAtB,EAA4B;AAC3B,UAAO,QAAP;AACA,GAFD,MAEO;AACN,UAAO,UAAP;AACA;AACD,EAPD;;AASA,QAAO,OAAP,CAAe,gBAAf,CAAgC,OAAhC,EAAyC,YAAM;AAC9C,SAAO,YAAP;AACA,MAAM,QAAS,OAAO,MAAR,GAAkB,eAAlB,GAAoC,iBAAlD;AACA,UAAQ,GAAR,CAAY,KAAZ,EAAmB,WAAnB;AACA,YAAU,IAAV,CAAe,KAAf,EAAsB,WAAtB;AACA,EALD;;AAOA,WAAU,SAAV,CAAoB,oBAApB,EAA0C,OAAO,OAAjD;AACA,WAAU,SAAV,CAAoB,mBAApB,EAAyC,YAAM;AAC9C,SAAO,QAAP;AACA,EAFD;;AAIA,WAAU,SAAV,CAAoB,YAApB,EAAkC,UAAC,WAAD,EAAiB;AAClD,MAAI,gBAAgB,WAApB,EAAiC,OAAO,QAAP;AACjC,EAFD;;AAIA,QAAO,MAAP;AACA;;kBAEc,U;;;;;;;;;ACrEf;;AAEA;;;;;;AAMA,SAAS,QAAT,CAAkB,OAAlB,EAA2B;AAC1B,KAAM,OAAO,EAAb;AACA,MAAK,KAAL,GAAa,OAAb;AACA,MAAK,MAAL,GAAc,KAAd;AACA,KAAM,MAAM,KAAK,KAAL,CAAW,YAAX,CAAwB,KAAxB,EAA+B,KAA/B,CAAqC,GAArC,CAAZ;AACA,MAAK,QAAL,GAAgB,IAAI,KAAJ,CAAU,CAAC,CAAX,EAAc,CAAd,CAAhB;;AAEA,MAAK,IAAL,GAAY,SAAS,QAAT,GAAoB;AAC/B,OAAK,MAAL,GAAc,IAAd;AACA,OAAK,KAAL,CAAW,IAAX;AACA,EAHD;;AAKA,MAAK,IAAL,GAAY,SAAS,QAAT,GAAoB;AAC/B,OAAK,MAAL,GAAc,KAAd;AACA,OAAK,KAAL,CAAW,KAAX;AACA,OAAK,KAAL,CAAW,WAAX,GAAyB,CAAzB;AACA,EAJD;;AAMA,MAAK,QAAL,GAAgB,SAAS,YAAT,GAAwB;AACvC,OAAK,MAAL,GAAc,IAAd;AACA,OAAK,KAAL,CAAW,MAAX,GAAoB,CAApB;AACA,EAHD;;AAKA,MAAK,UAAL,GAAkB,SAAS,cAAT,GAA0B;AAC3C,OAAK,MAAL,GAAc,KAAd;AACA,OAAK,KAAL,CAAW,MAAX,GAAoB,CAApB;AACA,EAHD;;AAKA,QAAO,IAAP;AACA;;kBAGc,Q;;;;;;;;;ACxCf;;AACA;;;;;;AAEA;;;;;;AAMA,SAAS,SAAT,CAAmB,EAAnB,EAAuB,UAAvB,EAAmC,SAAnC,EAA8C;AAC7C,KAAM,QAAQ,EAAd;AACA,OAAM,OAAN,GAAgB,EAAhB;AACA,KAAM,eAAe,cAAM,OAAN,EAAe,EAAf,CAArB;;AAEA,KAAM,QAAQ,EAAd;;AAEA;;AAEA,UAAS,YAAT,GAAwB;AACvB,MAAM,aAAa,MAAM,MAAN,CAAa;AAAA,UAAQ,KAAK,OAAb;AAAA,GAAb,EAAmC,MAAtD;AACA,MAAI,eAAe,MAAM,MAAzB,EAAiC;AAChC,SAAM,KAAN,GAAc,IAAd;AACA,SAAM,OAAN,CAAc,SAAd,CAAwB,GAAxB,CAA4B,OAA5B;AACA;AACD;;AAED;AACA;AACA,cAAa,GAAb,CAAiB,UAAC,WAAD,EAAiB;AACjC,MAAM,OAAO,oBAAS,WAAT,CAAb;AACA,MAAM,MAAM,YAAY,YAAZ,CAAyB,KAAzB,EAAgC,KAAhC,CAAsC,GAAtC,CAAZ;AACA,OAAK,QAAL,GAAgB,IAAI,KAAJ,CAAU,CAAC,CAAX,EAAc,CAAd,CAAhB;AACA,QAAM,IAAN,CAAW,IAAX;;AAEA,OAAK,KAAL,CAAW,gBAAX,CAA4B,gBAA5B,EAA8C,YAAM;AACnD,QAAK,OAAL,GAAe,IAAf;AACA;AACA,GAHD;AAIA,EAVD;;AAYA;AACA;AACA;;AAEA,UAAS,IAAT,GAAgB;AACf;AACA;AACA,MAAI,CAAC,MAAM,KAAX,EAAkB,OAAO,KAAP;AAClB,QAAM,GAAN,CAAU,UAAC,IAAD,EAAO,KAAP,EAAiB;AAC1B,QAAK,IAAL;AACA,aAAU,IAAV,CAAe,YAAf,EAA6B,KAA7B;AACA,GAHD;AAIA,QAAM,MAAN,GAAe,IAAf;AACA,QAAM,OAAN,CAAc,SAAd,CAAwB,GAAxB,CAA4B,SAA5B;AACA,SAAO,IAAP;AACA;;AAED,UAAS,IAAT,GAAgB;AACf,QAAM,GAAN,CAAU;AAAA,UAAQ,KAAK,IAAL,EAAR;AAAA,GAAV;AACA,QAAM,MAAN,GAAe,KAAf;AACA,QAAM,OAAN,CAAc,SAAd,CAAwB,MAAxB,CAA+B,SAA/B;AACA;;AAED;;;;AAIA,OAAM,OAAN,CAAc,gBAAd,CAA+B,OAA/B,EAAwC,YAAM;AAC7C,YAAU,IAAV,CAAe,aAAf,EAA8B,UAA9B;AACA,EAFD;;AAIA,WAAU,SAAV,CAAoB,aAApB,EAAmC,UAAC,QAAD,EAAc;AAChD,MAAI,aAAa,UAAjB,EAA6B;AAC5B;AACA,GAFD,MAEO;AACN;AACA;AACD,EAND;;AAQA,WAAU,SAAV,CAAoB,eAApB,EAAqC,UAAC,SAAD,EAAe;AACnD,MAAI,MAAM,MAAV,EAAkB,MAAM,SAAN,EAAiB,QAAjB;AAClB,EAFD;AAGA,WAAU,SAAV,CAAoB,iBAApB,EAAuC,UAAC,SAAD,EAAe;AACrD,MAAI,MAAM,MAAV,EAAkB,MAAM,SAAN,EAAiB,UAAjB;AAClB,EAFD;AAGA;AACA,WAAU,SAAV,CAAoB,mBAApB,EAAyC,YAAM;AAC9C,QAAM,GAAN,CAAU,UAAC,IAAD,EAAO,KAAP,EAAiB;AAC1B,QAAK,QAAL;AACA,aAAU,IAAV,CAAe,YAAf,EAA6B,KAA7B;AACA,GAHD;AAIA,EALD;;AAOA;;;;AAIA,aAAY,YAAM;AACjB,MAAI,MAAM,MAAV,EAAkB;AACjB,SAAM,GAAN,CAAU,UAAC,IAAD,EAAO,KAAP,EAAiB;AAC1B,QAAM,YAAa,KAAK,MAAN,GAAgB,WAAhB,GAA8B,aAAhD;AACA,QAAM,cAAc,KAAK,KAAL,CAAW,KAAK,KAAL,CAAW,WAAX,GAAyB,GAApC,IAA2C,GAA/D;AACA,YAAQ,GAAR,cAAuB,KAAvB,UAAiC,WAAjC,WAAkD,KAAK,QAAvD,WAAqE,SAArE;AACA,IAJD;AAKA,WAAQ,GAAR,CAAY,SAAZ;AACA;AACD,EATD,EASG,GATH;;AAWA,OAAM,UAAN,GAAmB,MAAM,MAAzB;AACA,QAAO,KAAP;AACA;;kBAGc,S;;;;;;;;;;;;;IChHT,a;AACL,0BAAc;AAAA;;AACb;AACA,OAAK,SAAL,GAAiB,IAAI,GAAJ,EAAjB;AACA;;;;4BAES,K,EAAO,Q,EAAU;AAC1B;AACA,OAAI,CAAC,KAAK,SAAL,CAAe,GAAf,CAAmB,KAAnB,CAAL,EAAgC,KAAK,SAAL,CAAe,GAAf,CAAmB,KAAnB,EAA0B,EAA1B;AAChC;AACA,QAAK,SAAL,CAAe,GAAf,CAAmB,KAAnB,EAA0B,IAA1B,CAA+B,QAA/B;AACA;;;8BAEW,K,EAAO,Q,EAAU;AAC5B,OAAM,YAAY,KAAK,SAAL,CAAe,GAAf,CAAmB,KAAnB,CAAlB;AACA,OAAI,cAAJ;;AAEA,OAAI,aAAa,UAAU,MAA3B,EAAmC;AAClC;AACA,YAAQ,UAAU,MAAV,CAAiB,UAAC,CAAD,EAAI,QAAJ,EAAc,YAAd,EAA+B;AACtD,YAAO,QAAP,KAAqB,UAArB,IAAmC,aAAa,QAAjD,GACC,IAAI,YADL,GAEC,CAFD;AAGA,KAJO,EAIL,CAAC,CAJI,CAAR;;AAMA,QAAI,QAAQ,CAAC,CAAb,EAAgB;AACf;AACA,eAAU,MAAV,CAAiB,KAAjB,EAAwB,CAAxB;AACA,UAAK,SAAL,CAAe,GAAf,CAAmB,KAAnB,EAA0B,SAA1B;AACA,YAAO,IAAP,CAJe,CAIF;AACb;AACD;AACD,UAAO,KAAP,CAnB4B,CAmBd;AACd;;;uBAEI,K,EAAgB;AAAA,qCAAN,IAAM;AAAN,QAAM;AAAA;;AACpB;AACA,OAAM,YAAY,KAAK,SAAL,CAAe,GAAf,CAAmB,KAAnB,CAAlB;;AAEA,OAAI,aAAa,UAAU,MAA3B,EAAmC;AAClC;AACA,cAAU,OAAV,CAAkB,UAAC,QAAD,EAAc;AAC/B,+BAAY,IAAZ;AACA,KAFD;AAGA,WAAO,IAAP;AACA;AACD,UAAO,KAAP;AACA;;;;;;AAGF,IAAM,YAAY,IAAI,aAAJ,EAAlB;;kBAEe,S;;;;;ACpDf;;AAIA;;;;AACA;;;;AACA;;;;;;AAEA;AATA;AAUA,IAAM,gBAAgB,cAAM,aAAN,CAAtB;;AAPA;AACA;;AAOA,IAAM,aAAa,iBAAS,yBAAT,KAAuC,KAA1D;AACA,IAAM,UAAU,EAAhB;AACA,IAAM,SAAS,EAAf;;AAEA;AACA,cAAc,GAAd,CAAkB,UAAC,KAAD,EAAQ,KAAR,EAAkB;AACnC,KAAM,WAAW,qBAAU,KAAV,EAAiB,KAAjB,sBAAjB;AACA,QAAO,IAAP,CAAY,QAAZ;AACA,CAHD;;AAKA,cAAM,0BAAN,EAAkC,GAAlC,CAAsC,UAAC,MAAD,EAAS,KAAT,EAAmB;AACxD,KAAM,YAAY,sBAAW,MAAX,EAAmB,KAAnB,sBAAlB;AACA,SAAQ,IAAR,CAAa,SAAb;AACA,CAHD;;AAKA;;;;AAIA,IAAI,UAAJ,EAAgB;AACf,YAAW,gBAAX,CAA4B,OAA5B,EAAqC,YAAM;AAC1C,sBAAU,IAAV,CAAe,mBAAf;AACA,EAFD;AAGA;;AAED","file":"stems.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nvar toArray = function toArray(list) {\n  return [].concat(_toConsumableArray(list));\n};\n\nvar first = function first(xs) {\n  return xs[0];\n};\n\nvar elemError = function elemError(e) {\n  throw new Error(\"\\\"\" + String(e) + \"\\\" does't exist in the document\");\n};\n\nvar getRoot = function getRoot(e) {\n  return !e ? document : document && document.body && document.body.contains(e) ? e : elemError(e);\n};\n\nvar query = exports.query = function query(q, e) {\n  var root = getRoot(e);\n  return root ? toArray(root.querySelectorAll(q)) : [];\n};\n\nvar queryOne = exports.queryOne = function queryOne(q, e) {\n  return first(query(q, e));\n};\n","\n/**\n * Receives a DOM element.\n * Returns an object with enable, activate, and deactivate methods\n * @param  {DOM element} element\n * @return {Shape}\n */\n\nfunction makeButton(el, buttonIndex, publisher) {\n\tconst button = {};\n\tbutton.element = el;\n\n\tbutton.enable = function enable() {\n\t\tbutton.enabled = true;\n\t\tbutton.element.classList.add('enabled');\n\t};\n\n\tbutton.disable = function disable() {\n\t\tbutton.enabled = false;\n\t\tbutton.element.classList.remove('enabled');\n\t};\n\n\tbutton.toggleEnabled = function toggleEnabled() {\n\t\tif (button.enabled) {\n\t\t\tbutton.disable();\n\t\t} else {\n\t\t\tbutton.enable();\n\t\t}\n\t};\n\n\tbutton.activate = function activate() {\n\t\tif (!button.enabled) button.enable();\n\t\tbutton.active = true;\n\t\tbutton.element.classList.add('active');\n\t};\n\n\tbutton.deactivate = function deactivate() {\n\t\tbutton.active = false;\n\t\tbutton.element.classList.remove('active');\n\t};\n\n\tbutton.toggleActive = function toggleActive(inputState) {\n\t\tbutton.active = inputState || !button.active;\n\t\tif (button.active === true) {\n\t\t\tbutton.activate();\n\t\t} else {\n\t\t\tbutton.deactivate();\n\t\t}\n\t};\n\n\tbutton.element.addEventListener('click', () => {\n\t\tbutton.toggleActive();\n\t\tconst event = (button.active) ? 'stemActivated' : 'stemDeactivated';\n\t\tconsole.log(event, buttonIndex);\n\t\tpublisher.emit(event, buttonIndex);\n\t});\n\n\tpublisher.subscribe('allButtonsDisabled', button.disable);\n\tpublisher.subscribe('allStemsActivated', () => {\n\t\tbutton.activate();\n\t});\n\n\tpublisher.subscribe('stemPlayed', (activeIndex) => {\n\t\tif (activeIndex === buttonIndex) button.activate();\n\t});\n\n\treturn button;\n}\n\nexport default makeButton;\n","import { query, queryOne } from '@artcommacode/q';\n\n/**\n * Receives a DOM element with links to audio files to be played in tandem as stems.\n * Returns an object with play/pause/mute methods\n * @param  {DOM element} element\n * @return {Stem}\n */\nfunction makeStem(element) {\n\tconst stem = {};\n\tstem.audio = element;\n\tstem.active = false;\n\tconst url = stem.audio.getAttribute('src').split('/');\n\tstem.fileName = url.slice(-1)[0];\n\n\tstem.play = function playStem() {\n\t\tstem.active = true;\n\t\tstem.audio.play();\n\t};\n\n\tstem.stop = function stopStem() {\n\t\tstem.active = false;\n\t\tstem.audio.pause();\n\t\tstem.audio.currentTime = 0;\n\t};\n\n\tstem.activate = function activateStem() {\n\t\tstem.active = true;\n\t\tstem.audio.volume = 1;\n\t};\n\n\tstem.deactivate = function deactivateStem() {\n\t\tstem.active = false;\n\t\tstem.audio.volume = 0;\n\t};\n\n\treturn stem;\n}\n\n\nexport default makeStem;\n","import { query, queryOne } from '@artcommacode/q';\nimport makeStem from './Stem';\n\n/**\n * Receives a DOM element with links to audio files to be played in tandem as stems.\n * Returns an object with play/pause/mute methods\n * @param  {DOM element} element\n * @return {Stem}\n */\nfunction makeTrack(el, trackIndex, publisher) {\n\tconst track = {};\n\ttrack.element = el;\n\tconst stemElements = query('audio', el);\n\n\tconst stems = [];\n\n\t// See if all of the tracks are ready\n\n\tfunction checkIfReady() {\n\t\tconst readyCount = stems.filter(stem => stem.isReady).length;\n\t\tif (readyCount === stems.length) {\n\t\t\ttrack.ready = true;\n\t\t\ttrack.element.classList.add('ready');\n\t\t}\n\t}\n\n\t// add each element to the tracks array.\n\t// When it's loaded,\n\tstemElements.map((stemElement) => {\n\t\tconst stem = makeStem(stemElement);\n\t\tconst url = stemElement.getAttribute('src').split('/');\n\t\tstem.fileName = url.slice(-1)[0];\n\t\tstems.push(stem);\n\n\t\tstem.audio.addEventListener('canplaythrough', () => {\n\t\t\tstem.isReady = true;\n\t\t\tcheckIfReady();\n\t\t});\n\t});\n\n\t// functions that we attach to the 'track' object are public &\n\t// usable from the outside.\n\t// Everything else is private.\n\n\tfunction play() {\n\t\t// don't do anything if it's not ready. The user shouldn't be\n\t\t// able to play the track until it's ready anyway, though.\n\t\tif (!track.ready) return false;\n\t\tstems.map((stem, index) => {\n\t\t\tstem.play();\n\t\t\tpublisher.emit('stemPlayed', index);\n\t\t});\n\t\ttrack.active = true;\n\t\ttrack.element.classList.add('playing');\n\t\treturn true;\n\t}\n\n\tfunction stop() {\n\t\tstems.map(stem => stem.stop());\n\t\ttrack.active = false;\n\t\ttrack.element.classList.remove('playing');\n\t}\n\n\t/**\n\t * Bind event listeners & emitters\n\t */\n\n\ttrack.element.addEventListener('click', () => {\n\t\tpublisher.emit('trackPlayed', trackIndex);\n\t});\n\n\tpublisher.subscribe('trackPlayed', (newIndex) => {\n\t\tif (newIndex === trackIndex) {\n\t\t\tplay();\n\t\t} else {\n\t\t\tstop();\n\t\t}\n\t});\n\n\tpublisher.subscribe('stemActivated', (stemIndex) => {\n\t\tif (track.active) stems[stemIndex].activate();\n\t});\n\tpublisher.subscribe('stemDeactivated', (stemIndex) => {\n\t\tif (track.active) stems[stemIndex].deactivate();\n\t});\n\t// publisher.subscribe('stemToggled', stemIndex => stems[stemIndex].toggle());\n\tpublisher.subscribe('allStemsActivated', () => {\n\t\tstems.map((stem, index) => {\n\t\t\tstem.activate()\n\t\t\tpublisher.emit('stemPlayed', index);\n\t\t});\n\t});\n\n\t/**\n\t * Debug logging\n\t */\n\n\tsetInterval(() => {\n\t\tif (track.active) {\n\t\t\tstems.map((stem, index) => {\n\t\t\t\tconst activated = (stem.active) ? 'activated' : 'deactivated';\n\t\t\t\tconst currentTime = Math.round(stem.audio.currentTime * 100) / 100;\n\t\t\t\tconsole.log(`   stem ${index}: ${currentTime} | ${stem.fileName} - ${activated}`);\n\t\t\t});\n\t\t\tconsole.log('*******');\n\t\t}\n\t}, 100);\n\n\ttrack.stemsCount = stems.length;\n\treturn track;\n}\n\n\nexport default makeTrack;\n","\nclass PubSubEmitter {\n\tconstructor() {\n\t\t// create a new Map to hold all of the topics\n\t\tthis.listeners = new Map();\n\t}\n\n\tsubscribe(topic, callback) {\n\t\t// if the listener does not hae the topic yet, add it.\n\t\tif (!this.listeners.has(topic)) this.listeners.set(topic, []);\n\t\t// push the callback to the topic's array\n\t\tthis.listeners.get(topic).push(callback);\n\t}\n\n\tunsubscribe(topic, callback) {\n\t\tconst listeners = this.listeners.get(topic);\n\t\tlet index;\n\n\t\tif (listeners && listeners.length) {\n\t\t\t// find the index of the callback we're removing\n\t\t\tindex = listeners.reduce((i, listener, currentIndex) => {\n\t\t\t\t(typeof(listener) === 'function' && listener === callback) ?\n\t\t\t\t\ti = currentIndex :\n\t\t\t\t\ti;\n\t\t\t}, -1);\n\n\t\t\tif (index > -1) {\n\t\t\t\t// if we found a match, splice it out, and resupply the map with the spliced array\n\t\t\t\tlisteners.splice(index, 1);\n\t\t\t\tthis.listeners.set(topic, listeners);\n\t\t\t\treturn true; // return true if we removed something\n\t\t\t}\n\t\t}\n\t\treturn false; // return false if we didn't\n\t}\n\n\temit(topic, ...args) {\n\t\t// get the listeners subscribed to the topic\n\t\tconst listeners = this.listeners.get(topic);\n\n\t\tif (listeners && listeners.length) {\n\t\t\t// execute each callback with any supplied arguments\n\t\t\tlisteners.forEach((listener) => {\n\t\t\t\tlistener(...args);\n\t\t\t});\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n}\n\nconst publisher = new PubSubEmitter();\n\nexport default publisher;\n","// A small utility for getting DOM elements\nimport { query, queryOne } from '@artcommacode/q';\n\n// A component you can use to emit and subscribe to events.\n// Helpful to decouple UI stuff\nimport publisher from './components/publisher';\nimport makeTrack from './components/Track';\nimport makeButton from './components/Button';\n\n// first, just find the elements\nconst trackElements = query('.stem-track');\nconst everything = queryOne('.stem-buttons .play-all') || false;\nconst buttons = [];\nconst tracks = [];\n\n// add each composed track to an array\ntrackElements.map((track, index) => {\n\tconst newTrack = makeTrack(track, index, publisher);\n\ttracks.push(newTrack);\n});\n\nquery('.stem-buttons .play-stem').map((button, index) => {\n\tconst newButton = makeButton(button, index, publisher);\n\tbuttons.push(newButton);\n});\n\n/**\n * Event Listeners\n */\n\nif (everything) {\n\teverything.addEventListener('click', () => {\n\t\tpublisher.emit('allStemsActivated');\n\t});\n}\n\n// Use each track element as the source of a Stem object\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvQGFydGNvbW1hY29kZS9xL2luZGV4LmpzIiwic3JjL2pzL2NvbXBvbmVudHMvQnV0dG9uLmpzIiwic3JjL2pzL2NvbXBvbmVudHMvU3RlbS5qcyIsInNyYy9qcy9jb21wb25lbnRzL1RyYWNrLmpzIiwic3JjL2pzL2NvbXBvbmVudHMvcHVibGlzaGVyLmpzIiwic3JjL2pzL3N0ZW1zLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7OztBQy9CQTs7Ozs7OztBQU9BLFNBQVMsVUFBVCxDQUFvQixFQUFwQixFQUF3QixXQUF4QixFQUFxQyxTQUFyQyxFQUFnRDtBQUMvQyxLQUFNLFNBQVMsRUFBZjtBQUNBLFFBQU8sT0FBUCxHQUFpQixFQUFqQjs7QUFFQSxRQUFPLE1BQVAsR0FBZ0IsU0FBUyxNQUFULEdBQWtCO0FBQ2pDLFNBQU8sT0FBUCxHQUFpQixJQUFqQjtBQUNBLFNBQU8sT0FBUCxDQUFlLFNBQWYsQ0FBeUIsR0FBekIsQ0FBNkIsU0FBN0I7QUFDQSxFQUhEOztBQUtBLFFBQU8sT0FBUCxHQUFpQixTQUFTLE9BQVQsR0FBbUI7QUFDbkMsU0FBTyxPQUFQLEdBQWlCLEtBQWpCO0FBQ0EsU0FBTyxPQUFQLENBQWUsU0FBZixDQUF5QixNQUF6QixDQUFnQyxTQUFoQztBQUNBLEVBSEQ7O0FBS0EsUUFBTyxhQUFQLEdBQXVCLFNBQVMsYUFBVCxHQUF5QjtBQUMvQyxNQUFJLE9BQU8sT0FBWCxFQUFvQjtBQUNuQixVQUFPLE9BQVA7QUFDQSxHQUZE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QixLQUFuQixzQkFBbEI7QUFDQSxTQUFRLElBQVIsQ0FBYSxTQUFiO0FBQ0EsQ0FIRDs7QUFLQTs7OztBQUlBLElBQUksVUFBSixFQUFnQjtBQUNmLFlBQVcsZ0JBQVgsQ0FBNEIsT0FBNUIsRUFBcUMsWUFBTTtBQUMxQyxzQkFBVSxJQUFWLENBQWUsbUJBQWY7QUFDQSxFQUZEO0FBR0E7O0FBRUQiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbmZ1bmN0aW9uIF90b0NvbnN1bWFibGVBcnJheShhcnIpIHsgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgeyBmb3IgKHZhciBpID0gMCwgYXJyMiA9IEFycmF5KGFyci5sZW5ndGgpOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7IGFycjJbaV0gPSBhcnJbaV07IH0gcmV0dXJuIGFycjI7IH0gZWxzZSB7IHJldHVybiBBcnJheS5mcm9tKGFycik7IH0gfVxuXG52YXIgdG9BcnJheSA9IGZ1bmN0aW9uIHRvQXJyYXkobGlzdCkge1xuICByZXR1cm4gW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheShsaXN0KSk7XG59O1xuXG52YXIgZmlyc3QgPSBmdW5jdGlvbiBmaXJzdCh4cykge1xuICByZXR1cm4geHNbMF07XG59O1xuXG52YXIgZWxlbUVycm9yID0gZnVuY3Rpb24gZWxlbUVycm9yKGUpIHtcbiAgdGhyb3cgbmV3IEVycm9yKFwiXFxcIlwiICsgU3RyaW5nKGUpICsgXCJcXFwiIGRvZXMndCBleGlzdCBpbiB0aGUgZG9jdW1lbnRcIik7XG59O1xuXG52YXIgZ2V0Um9vdCA9IGZ1bmN0aW9uIGdldFJvb3QoZSkge1xuICByZXR1cm4gIWUgPyBkb2N1bWVudCA6IGRvY3VtZW50ICYmIGRvY3VtZW50LmJvZHkgJiYgZG9jdW1lbnQuYm9keS5jb250YWlucyhlKSA/IGUgOiBlbGVtRXJyb3IoZSk7XG59O1xuXG52YXIgcXVlcnkgPSBleHBvcnRzLnF1ZXJ5ID0gZnVuY3Rpb24gcXVlcnkocSwgZSkge1xuICB2YXIgcm9vdCA9IGdldFJvb3QoZSk7XG4gIHJldHVybiByb290ID8gdG9BcnJheShyb290LnF1ZXJ5U2VsZWN0b3JBbGwocSkpIDogW107XG59O1xuXG52YXIgcXVlcnlPbmUgPSBleHBvcnRzLnF1ZXJ5T25lID0gZnVuY3Rpb24gcXVlcnlPbmUocSwgZSkge1xuICByZXR1cm4gZmlyc3QocXVlcnkocSwgZSkpO1xufTtcbiIsIlxuLyoqXG4gKiBSZWNlaXZlcyBhIERPTSBlbGVtZW50LlxuICogUmV0dXJucyBhbiBvYmplY3Qgd2l0aCBlbmFibGUsIGFjdGl2YXRlLCBhbmQgZGVhY3RpdmF0ZSBtZXRob2RzXG4gKiBAcGFyYW0gIHtET00gZWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7U2hhcGV9XG4gKi9cblxuZnVuY3Rpb24gbWFrZUJ1dHRvbihlbCwgYnV0dG9uSW5kZXgsIHB1Ymxpc2hlcikge1xuXHRjb25zdCBidXR0b24gPSB7fTtcblx0YnV0dG9uLmVsZW1lbnQgPSBlbDtcblxuXHRidXR0b24uZW5hYmxlID0gZnVuY3Rpb24gZW5hYmxlKCkge1xuXHRcdGJ1dHRvbi5lbmFibGVkID0gdHJ1ZTtcblx0XHRidXR0b24uZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdlbmFibGVkJyk7XG5cdH07XG5cblx0YnV0dG9uLmRpc2FibGUgPSBmdW5jdGlvbiBkaXNhYmxlKCkge1xuXHRcdGJ1dHRvbi5lbmFibGVkID0gZmFsc2U7XG5cdFx0YnV0dG9uLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnZW5hYmxlZCcpO1xuXHR9O1xuXG5cdGJ1dHRvbi50b2dnbGVFbmFibGVkID0gZnVuY3Rpb24gdG9nZ2xlRW5hYmxlZCgpIHtcblx0XHRpZiAoYnV0dG9uLmVuYWJsZWQpIHtcblx0XHRcdGJ1dHRvbi5kaXNhYmxlKCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGJ1dHRvbi5lbmFibGUoKTtcblx0XHR9XG5cdH07XG5cblx0YnV0dG9uLmFjdGl2YXRlID0gZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG5cdFx0aWYgKCFidXR0b24uZW5hYmxlZCkgYnV0dG9uLmVuYWJsZSgpO1xuXHRcdGJ1dHRvbi5hY3RpdmUgPSB0cnVlO1xuXHRcdGJ1dHRvbi5lbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuXHR9O1xuXG5cdGJ1dHRvbi5kZWFjdGl2YXRlID0gZnVuY3Rpb24gZGVhY3RpdmF0ZSgpIHtcblx0XHRidXR0b24uYWN0aXZlID0gZmFsc2U7XG5cdFx0YnV0dG9uLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XG5cdH07XG5cblx0YnV0dG9uLnRvZ2dsZUFjdGl2ZSA9IGZ1bmN0aW9uIHRvZ2dsZUFjdGl2ZShpbnB1dFN0YXRlKSB7XG5cdFx0YnV0dG9uLmFjdGl2ZSA9IGlucHV0U3RhdGUgfHwgIWJ1dHRvbi5hY3RpdmU7XG5cdFx0aWYgKGJ1dHRvbi5hY3RpdmUgPT09IHRydWUpIHtcblx0XHRcdGJ1dHRvbi5hY3RpdmF0ZSgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRidXR0b24uZGVhY3RpdmF0ZSgpO1xuXHRcdH1cblx0fTtcblxuXHRidXR0b24uZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRidXR0b24udG9nZ2xlQWN0aXZlKCk7XG5cdFx0Y29uc3QgZXZlbnQgPSAoYnV0dG9uLmFjdGl2ZSkgPyAnc3RlbUFjdGl2YXRlZCcgOiAnc3RlbURlYWN0aXZhdGVkJztcblx0XHRjb25zb2xlLmxvZyhldmVudCwgYnV0dG9uSW5kZXgpO1xuXHRcdHB1Ymxpc2hlci5lbWl0KGV2ZW50LCBidXR0b25JbmRleCk7XG5cdH0pO1xuXG5cdHB1Ymxpc2hlci5zdWJzY3JpYmUoJ2FsbEJ1dHRvbnNEaXNhYmxlZCcsIGJ1dHRvbi5kaXNhYmxlKTtcblx0cHVibGlzaGVyLnN1YnNjcmliZSgnYWxsU3RlbXNBY3RpdmF0ZWQnLCAoKSA9PiB7XG5cdFx0YnV0dG9uLmFjdGl2YXRlKCk7XG5cdH0pO1xuXG5cdHB1Ymxpc2hlci5zdWJzY3JpYmUoJ3N0ZW1QbGF5ZWQnLCAoYWN0aXZlSW5kZXgpID0+IHtcblx0XHRpZiAoYWN0aXZlSW5kZXggPT09IGJ1dHRvbkluZGV4KSBidXR0b24uYWN0aXZhdGUoKTtcblx0fSk7XG5cblx0cmV0dXJuIGJ1dHRvbjtcbn1cblxuZXhwb3J0IGRlZmF1bHQgbWFrZUJ1dHRvbjtcbiIsImltcG9ydCB7IHF1ZXJ5LCBxdWVyeU9uZSB9IGZyb20gJ0BhcnRjb21tYWNvZGUvcSc7XG5cbi8qKlxuICogUmVjZWl2ZXMgYSBET00gZWxlbWVudCB3aXRoIGxpbmtzIHRvIGF1ZGlvIGZpbGVzIHRvIGJlIHBsYXllZCBpbiB0YW5kZW0gYXMgc3RlbXMuXG4gKiBSZXR1cm5zIGFuIG9iamVjdCB3aXRoIHBsYXkvcGF1c2UvbXV0ZSBtZXRob2RzXG4gKiBAcGFyYW0gIHtET00gZWxlbWVudH0gZWxlbWVudFxuICogQHJldHVybiB7U3RlbX1cbiAqL1xuZnVuY3Rpb24gbWFrZVN0ZW0oZWxlbWVudCkge1xuXHRjb25zdCBzdGVtID0ge307XG5cdHN0ZW0uYXVkaW8gPSBlbGVtZW50O1xuXHRzdGVtLmFjdGl2ZSA9IGZhbHNlO1xuXHRjb25zdCB1cmwgPSBzdGVtLmF1ZGlvLmdldEF0dHJpYnV0ZSgnc3JjJykuc3BsaXQoJy8nKTtcblx0c3RlbS5maWxlTmFtZSA9IHVybC5zbGljZSgtMSlbMF07XG5cblx0c3RlbS5wbGF5ID0gZnVuY3Rpb24gcGxheVN0ZW0oKSB7XG5cdFx0c3RlbS5hY3RpdmUgPSB0cnVlO1xuXHRcdHN0ZW0uYXVkaW8ucGxheSgpO1xuXHR9O1xuXG5cdHN0ZW0uc3RvcCA9IGZ1bmN0aW9uIHN0b3BTdGVtKCkge1xuXHRcdHN0ZW0uYWN0aXZlID0gZmFsc2U7XG5cdFx0c3RlbS5hdWRpby5wYXVzZSgpO1xuXHRcdHN0ZW0uYXVkaW8uY3VycmVudFRpbWUgPSAwO1xuXHR9O1xuXG5cdHN0ZW0uYWN0aXZhdGUgPSBmdW5jdGlvbiBhY3RpdmF0ZVN0ZW0oKSB7XG5cdFx0c3RlbS5hY3RpdmUgPSB0cnVlO1xuXHRcdHN0ZW0uYXVkaW8udm9sdW1lID0gMTtcblx0fTtcblxuXHRzdGVtLmRlYWN0aXZhdGUgPSBmdW5jdGlvbiBkZWFjdGl2YXRlU3RlbSgpIHtcblx0XHRzdGVtLmFjdGl2ZSA9IGZhbHNlO1xuXHRcdHN0ZW0uYXVkaW8udm9sdW1lID0gMDtcblx0fTtcblxuXHRyZXR1cm4gc3RlbTtcbn1cblxuXG5leHBvcnQgZGVmYXVsdCBtYWtlU3RlbTtcbiIsImltcG9ydCB7IHF1ZXJ5LCBxdWVyeU9uZSB9IGZyb20gJ0BhcnRjb21tYWNvZGUvcSc7XG5pbXBvcnQgbWFrZVN0ZW0gZnJvbSAnLi9TdGVtJztcblxuLyoqXG4gKiBSZWNlaXZlcyBhIERPTSBlbGVtZW50IHdpdGggbGlua3MgdG8gYXVkaW8gZmlsZXMgdG8gYmUgcGxheWVkIGluIHRhbmRlbSBhcyBzdGVtcy5cbiAqIFJldHVybnMgYW4gb2JqZWN0IHdpdGggcGxheS9wYXVzZS9tdXRlIG1ldGhvZHNcbiAqIEBwYXJhbSAge0RPTSBlbGVtZW50fSBlbGVtZW50XG4gKiBAcmV0dXJuIHtTdGVtfVxuICovXG5mdW5jdGlvbiBtYWtlVHJhY2soZWwsIHRyYWNrSW5kZXgsIHB1Ymxpc2hlcikge1xuXHRjb25zdCB0cmFjayA9IHt9O1xuXHR0cmFjay5lbGVtZW50ID0gZWw7XG5cdGNvbnN0IHN0ZW1FbGVtZW50cyA9IHF1ZXJ5KCdhdWRpbycsIGVsKTtcblxuXHRjb25zdCBzdGVtcyA9IFtdO1xuXG5cdC8vIFNlZSBpZiBhbGwgb2YgdGhlIHRyYWNrcyBhcmUgcmVhZHlcblxuXHRmdW5jdGlvbiBjaGVja0lmUmVhZHkoKSB7XG5cdFx0Y29uc3QgcmVhZHlDb3VudCA9IHN0ZW1zLmZpbHRlcihzdGVtID0+IHN0ZW0uaXNSZWFkeSkubGVuZ3RoO1xuXHRcdGlmIChyZWFkeUNvdW50ID09PSBzdGVtcy5sZW5ndGgpIHtcblx0XHRcdHRyYWNrLnJlYWR5ID0gdHJ1ZTtcblx0XHRcdHRyYWNrLmVsZW1lbnQuY2xhc3NMaXN0LmFkZCgncmVhZHknKTtcblx0XHR9XG5cdH1cblxuXHQvLyBhZGQgZWFjaCBlbGVtZW50IHRvIHRoZSB0cmFja3MgYXJyYXkuXG5cdC8vIFdoZW4gaXQncyBsb2FkZWQsXG5cdHN0ZW1FbGVtZW50cy5tYXAoKHN0ZW1FbGVtZW50KSA9PiB7XG5cdFx0Y29uc3Qgc3RlbSA9IG1ha2VTdGVtKHN0ZW1FbGVtZW50KTtcblx0XHRjb25zdCB1cmwgPSBzdGVtRWxlbWVudC5nZXRBdHRyaWJ1dGUoJ3NyYycpLnNwbGl0KCcvJyk7XG5cdFx0c3RlbS5maWxlTmFtZSA9IHVybC5zbGljZSgtMSlbMF07XG5cdFx0c3RlbXMucHVzaChzdGVtKTtcblxuXHRcdHN0ZW0uYXVkaW8uYWRkRXZlbnRMaXN0ZW5lcignY2FucGxheXRocm91Z2gnLCAoKSA9PiB7XG5cdFx0XHRzdGVtLmlzUmVhZHkgPSB0cnVlO1xuXHRcdFx0Y2hlY2tJZlJlYWR5KCk7XG5cdFx0fSk7XG5cdH0pO1xuXG5cdC8vIGZ1bmN0aW9ucyB0aGF0IHdlIGF0dGFjaCB0byB0aGUgJ3RyYWNrJyBvYmplY3QgYXJlIHB1YmxpYyAmXG5cdC8vIHVzYWJsZSBmcm9tIHRoZSBvdXRzaWRlLlxuXHQvLyBFdmVyeXRoaW5nIGVsc2UgaXMgcHJpdmF0ZS5cblxuXHRmdW5jdGlvbiBwbGF5KCkge1xuXHRcdC8vIGRvbid0IGRvIGFueXRoaW5nIGlmIGl0J3Mgbm90IHJlYWR5LiBUaGUgdXNlciBzaG91bGRuJ3QgYmVcblx0XHQvLyBhYmxlIHRvIHBsYXkgdGhlIHRyYWNrIHVudGlsIGl0J3MgcmVhZHkgYW55d2F5LCB0aG91Z2guXG5cdFx0aWYgKCF0cmFjay5yZWFkeSkgcmV0dXJuIGZhbHNlO1xuXHRcdHN0ZW1zLm1hcCgoc3RlbSwgaW5kZXgpID0+IHtcblx0XHRcdHN0ZW0ucGxheSgpO1xuXHRcdFx0cHVibGlzaGVyLmVtaXQoJ3N0ZW1QbGF5ZWQnLCBpbmRleCk7XG5cdFx0fSk7XG5cdFx0dHJhY2suYWN0aXZlID0gdHJ1ZTtcblx0XHR0cmFjay5lbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3BsYXlpbmcnKTtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXG5cdGZ1bmN0aW9uIHN0b3AoKSB7XG5cdFx0c3RlbXMubWFwKHN0ZW0gPT4gc3RlbS5zdG9wKCkpO1xuXHRcdHRyYWNrLmFjdGl2ZSA9IGZhbHNlO1xuXHRcdHRyYWNrLmVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgncGxheWluZycpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEJpbmQgZXZlbnQgbGlzdGVuZXJzICYgZW1pdHRlcnNcblx0ICovXG5cblx0dHJhY2suZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcblx0XHRwdWJsaXNoZXIuZW1pdCgndHJhY2tQbGF5ZWQnLCB0cmFja0luZGV4KTtcblx0fSk7XG5cblx0cHVibGlzaGVyLnN1YnNjcmliZSgndHJhY2tQbGF5ZWQnLCAobmV3SW5kZXgpID0+IHtcblx0XHRpZiAobmV3SW5kZXggPT09IHRyYWNrSW5kZXgpIHtcblx0XHRcdHBsYXkoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0c3RvcCgpO1xuXHRcdH1cblx0fSk7XG5cblx0cHVibGlzaGVyLnN1YnNjcmliZSgnc3RlbUFjdGl2YXRlZCcsIChzdGVtSW5kZXgpID0+IHtcblx0XHRpZiAodHJhY2suYWN0aXZlKSBzdGVtc1tzdGVtSW5kZXhdLmFjdGl2YXRlKCk7XG5cdH0pO1xuXHRwdWJsaXNoZXIuc3Vic2NyaWJlKCdzdGVtRGVhY3RpdmF0ZWQnLCAoc3RlbUluZGV4KSA9PiB7XG5cdFx0aWYgKHRyYWNrLmFjdGl2ZSkgc3RlbXNbc3RlbUluZGV4XS5kZWFjdGl2YXRlKCk7XG5cdH0pO1xuXHQvLyBwdWJsaXNoZXIuc3Vic2NyaWJlKCdzdGVtVG9nZ2xlZCcsIHN0ZW1JbmRleCA9PiBzdGVtc1tzdGVtSW5kZXhdLnRvZ2dsZSgpKTtcblx0cHVibGlzaGVyLnN1YnNjcmliZSgnYWxsU3RlbXNBY3RpdmF0ZWQnLCAoKSA9PiB7XG5cdFx0c3RlbXMubWFwKChzdGVtLCBpbmRleCkgPT4ge1xuXHRcdFx0c3RlbS5hY3RpdmF0ZSgpXG5cdFx0XHRwdWJsaXNoZXIuZW1pdCgnc3RlbVBsYXllZCcsIGluZGV4KTtcblx0XHR9KTtcblx0fSk7XG5cblx0LyoqXG5cdCAqIERlYnVnIGxvZ2dpbmdcblx0ICovXG5cblx0c2V0SW50ZXJ2YWwoKCkgPT4ge1xuXHRcdGlmICh0cmFjay5hY3RpdmUpIHtcblx0XHRcdHN0ZW1zLm1hcCgoc3RlbSwgaW5kZXgpID0+IHtcblx0XHRcdFx0Y29uc3QgYWN0aXZhdGVkID0gKHN0ZW0uYWN0aXZlKSA/ICdhY3RpdmF0ZWQnIDogJ2RlYWN0aXZhdGVkJztcblx0XHRcdFx0Y29uc3QgY3VycmVudFRpbWUgPSBNYXRoLnJvdW5kKHN0ZW0uYXVkaW8uY3VycmVudFRpbWUgKiAxMDApIC8gMTAwO1xuXHRcdFx0XHRjb25zb2xlLmxvZyhgICAgc3RlbSAke2luZGV4fTogJHtjdXJyZW50VGltZX0gfCAke3N0ZW0uZmlsZU5hbWV9IC0gJHthY3RpdmF0ZWR9YCk7XG5cdFx0XHR9KTtcblx0XHRcdGNvbnNvbGUubG9nKCcqKioqKioqJyk7XG5cdFx0fVxuXHR9LCAxMDApO1xuXG5cdHRyYWNrLnN0ZW1zQ291bnQgPSBzdGVtcy5sZW5ndGg7XG5cdHJldHVybiB0cmFjaztcbn1cblxuXG5leHBvcnQgZGVmYXVsdCBtYWtlVHJhY2s7XG4iLCJcbmNsYXNzIFB1YlN1YkVtaXR0ZXIge1xuXHRjb25zdHJ1Y3RvcigpIHtcblx0XHQvLyBjcmVhdGUgYSBuZXcgTWFwIHRvIGhvbGQgYWxsIG9mIHRoZSB0b3BpY3Ncblx0XHR0aGlzLmxpc3RlbmVycyA9IG5ldyBNYXAoKTtcblx0fVxuXG5cdHN1YnNjcmliZSh0b3BpYywgY2FsbGJhY2spIHtcblx0XHQvLyBpZiB0aGUgbGlzdGVuZXIgZG9lcyBub3QgaGFlIHRoZSB0b3BpYyB5ZXQsIGFkZCBpdC5cblx0XHRpZiAoIXRoaXMubGlzdGVuZXJzLmhhcyh0b3BpYykpIHRoaXMubGlzdGVuZXJzLnNldCh0b3BpYywgW10pO1xuXHRcdC8vIHB1c2ggdGhlIGNhbGxiYWNrIHRvIHRoZSB0b3BpYydzIGFycmF5XG5cdFx0dGhpcy5saXN0ZW5lcnMuZ2V0KHRvcGljKS5wdXNoKGNhbGxiYWNrKTtcblx0fVxuXG5cdHVuc3Vic2NyaWJlKHRvcGljLCBjYWxsYmFjaykge1xuXHRcdGNvbnN0IGxpc3RlbmVycyA9IHRoaXMubGlzdGVuZXJzLmdldCh0b3BpYyk7XG5cdFx0bGV0IGluZGV4O1xuXG5cdFx0aWYgKGxpc3RlbmVycyAmJiBsaXN0ZW5lcnMubGVuZ3RoKSB7XG5cdFx0XHQvLyBmaW5kIHRoZSBpbmRleCBvZiB0aGUgY2FsbGJhY2sgd2UncmUgcmVtb3Zpbmdcblx0XHRcdGluZGV4ID0gbGlzdGVuZXJzLnJlZHVjZSgoaSwgbGlzdGVuZXIsIGN1cnJlbnRJbmRleCkgPT4ge1xuXHRcdFx0XHQodHlwZW9mKGxpc3RlbmVyKSA9PT0gJ2Z1bmN0aW9uJyAmJiBsaXN0ZW5lciA9PT0gY2FsbGJhY2spID9cblx0XHRcdFx0XHRpID0gY3VycmVudEluZGV4IDpcblx0XHRcdFx0XHRpO1xuXHRcdFx0fSwgLTEpO1xuXG5cdFx0XHRpZiAoaW5kZXggPiAtMSkge1xuXHRcdFx0XHQvLyBpZiB3ZSBmb3VuZCBhIG1hdGNoLCBzcGxpY2UgaXQgb3V0LCBhbmQgcmVzdXBwbHkgdGhlIG1hcCB3aXRoIHRoZSBzcGxpY2VkIGFycmF5XG5cdFx0XHRcdGxpc3RlbmVycy5zcGxpY2UoaW5kZXgsIDEpO1xuXHRcdFx0XHR0aGlzLmxpc3RlbmVycy5zZXQodG9waWMsIGxpc3RlbmVycyk7XG5cdFx0XHRcdHJldHVybiB0cnVlOyAvLyByZXR1cm4gdHJ1ZSBpZiB3ZSByZW1vdmVkIHNvbWV0aGluZ1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gZmFsc2U7IC8vIHJldHVybiBmYWxzZSBpZiB3ZSBkaWRuJ3Rcblx0fVxuXG5cdGVtaXQodG9waWMsIC4uLmFyZ3MpIHtcblx0XHQvLyBnZXQgdGhlIGxpc3RlbmVycyBzdWJzY3JpYmVkIHRvIHRoZSB0b3BpY1xuXHRcdGNvbnN0IGxpc3RlbmVycyA9IHRoaXMubGlzdGVuZXJzLmdldCh0b3BpYyk7XG5cblx0XHRpZiAobGlzdGVuZXJzICYmIGxpc3RlbmVycy5sZW5ndGgpIHtcblx0XHRcdC8vIGV4ZWN1dGUgZWFjaCBjYWxsYmFjayB3aXRoIGFueSBzdXBwbGllZCBhcmd1bWVudHNcblx0XHRcdGxpc3RlbmVycy5mb3JFYWNoKChsaXN0ZW5lcikgPT4ge1xuXHRcdFx0XHRsaXN0ZW5lciguLi5hcmdzKTtcblx0XHRcdH0pO1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxufVxuXG5jb25zdCBwdWJsaXNoZXIgPSBuZXcgUHViU3ViRW1pdHRlcigpO1xuXG5leHBvcnQgZGVmYXVsdCBwdWJsaXNoZXI7XG4iLCIvLyBBIHNtYWxsIHV0aWxpdHkgZm9yIGdldHRpbmcgRE9NIGVsZW1lbnRzXG5pbXBvcnQgeyBxdWVyeSwgcXVlcnlPbmUgfSBmcm9tICdAYXJ0Y29tbWFjb2RlL3EnO1xuXG4vLyBBIGNvbXBvbmVudCB5b3UgY2FuIHVzZSB0byBlbWl0IGFuZCBzdWJzY3JpYmUgdG8gZXZlbnRzLlxuLy8gSGVscGZ1bCB0byBkZWNvdXBsZSBVSSBzdHVmZlxuaW1wb3J0IHB1Ymxpc2hlciBmcm9tICcuL2NvbXBvbmVudHMvcHVibGlzaGVyJztcbmltcG9ydCBtYWtlVHJhY2sgZnJvbSAnLi9jb21wb25lbnRzL1RyYWNrJztcbmltcG9ydCBtYWtlQnV0dG9uIGZyb20gJy4vY29tcG9uZW50cy9CdXR0b24nO1xuXG4vLyBmaXJzdCwganVzdCBmaW5kIHRoZSBlbGVtZW50c1xuY29uc3QgdHJhY2tFbGVtZW50cyA9IHF1ZXJ5KCcuc3RlbS10cmFjaycpO1xuY29uc3QgZXZlcnl0aGluZyA9IHF1ZXJ5T25lKCcuc3RlbS1idXR0b25zIC5wbGF5LWFsbCcpIHx8IGZhbHNlO1xuY29uc3QgYnV0dG9ucyA9IFtdO1xuY29uc3QgdHJhY2tzID0gW107XG5cbi8vIGFkZCBlYWNoIGNvbXBvc2VkIHRyYWNrIHRvIGFuIGFycmF5XG50cmFja0VsZW1lbnRzLm1hcCgodHJhY2ssIGluZGV4KSA9PiB7XG5cdGNvbnN0IG5ld1RyYWNrID0gbWFrZVRyYWNrKHRyYWNrLCBpbmRleCwgcHVibGlzaGVyKTtcblx0dHJhY2tzLnB1c2gobmV3VHJhY2spO1xufSk7XG5cbnF1ZXJ5KCcuc3RlbS1idXR0b25zIC5wbGF5LXN0ZW0nKS5tYXAoKGJ1dHRvbiwgaW5kZXgpID0+IHtcblx0Y29uc3QgbmV3QnV0dG9uID0gbWFrZUJ1dHRvbihidXR0b24sIGluZGV4LCBwdWJsaXNoZXIpO1xuXHRidXR0b25zLnB1c2gobmV3QnV0dG9uKTtcbn0pO1xuXG4vKipcbiAqIEV2ZW50IExpc3RlbmVyc1xuICovXG5cbmlmIChldmVyeXRoaW5nKSB7XG5cdGV2ZXJ5dGhpbmcuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG5cdFx0cHVibGlzaGVyLmVtaXQoJ2FsbFN0ZW1zQWN0aXZhdGVkJyk7XG5cdH0pO1xufVxuXG4vLyBVc2UgZWFjaCB0cmFjayBlbGVtZW50IGFzIHRoZSBzb3VyY2Ugb2YgYSBTdGVtIG9iamVjdFxuIl19"}